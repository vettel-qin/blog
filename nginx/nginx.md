# Nginx 常用命令

查看版本

```
  ./nginx -v
```

启动

```
  ./nginx
```

关闭（有两种方式）

```
 ./nginx -s stop
 ./nginx -s quit
```

重启

```
  ./nginx -s reload
```

```
systemctl start firewalld  # 开启防火墙
systemctl stop firewalld   # 关闭防火墙
systemctl status firewalld # 查看防火墙开启状态，显示running则是正在运行
firewall-cmd --reload      # 重启防火墙，永久打开端口需要reload一下
```

# 正向代理

一般的访问流程是客户端直接向目标服务器发送请求并获取内容，使用正向代理后，客户端改为向代理服务器发送请求，并指定目标服务器（原始服务器），然后由代理服务器和原始服务器通信，转交请求并获得的内容，再返回给客户端。正向代理隐藏了真实的客户端，为客户端收发请求，使真实客户端对服务器不可见；

举个具体的例子 🌰，你的浏览器无法直接访问谷哥，这时候可以通过一个代理服务器来帮助你访问谷哥，那么这个服务器就叫正向代理。

# 反向代理

与一般访问流程相比，使用反向代理后，直接收到请求的服务器是代理服务器，然后将请求转发给内部网络上真正进行处理的服务器，得到的结果返回给客户端。反向代理隐藏了真实的服务器，为服务器收发请求，使真实服务器对客户端不可见。一般在处理跨域请求的时候比较常用。现在基本上所有的大型网站都设置了反向代理。

举个具体的例子 🌰，去饭店吃饭，可以点川菜、粤菜、江浙菜，饭店也分别有三个菜系的厨师 👨‍🍳，但是你作为顾客不用管哪个厨师给你做的菜，只用点菜即可，小二将你菜单中的菜分配给不同的厨师来具体处理，那么这个小二就是反向代理服务器。

简单的说，一般给客户端做代理的都是正向代理，给服务器做代理的就是反向代理。

# 负载均衡

使用多个服务器，然后将请求分发到各个服务器上，将负载分发到不同的服务器，这就是负载均衡，核心是「分摊压力」。Nginx 实现负载均衡，一般来说指的是将请求转发给服务器集群。

举个具体的例子 🌰，晚高峰乘坐地铁的时候，入站口经常会有地铁工作人员大喇叭“请走 B 口，B 口人少车空....”，这个工作人员的作用就是负载均衡。

# 动静分离

为了加快网站的解析速度，可以把动态页面和静态页面由不同的服务器来解析，加快解析速度，降低原来单个服务器的压力

# pm2

安装 pm2 并创建软链接

```
npm install pm2 -g
ln -s /usr/local/nodejs/bin/pm2 /usr/local/bin/pm2
```

# pm2 基本功能命令

| 功能                  | 命令                                  |
| --------------------- | ------------------------------------- |
| 启动进程/应用         | pm2 start bin/abc 或 pm2 start app.js |
| 重命名进程/应用       | pm2 start app.js --name abc           |
| 添加进程/应用         | pm2 start bin/abc --watch             |
| 结束进程/应用         | pm2 stop abc                          |
| 结束所有进程/应用     | pm2 stop all                          |
| 删除进程/应用         | pm2 delete abc                        |
| 删除所有进程/应用     | pm2 delete all                        |
| 列出所有进程/应用     | pm2 list                              |
| 查看进程/应用详情     | pm2 show abc 或 pm2 describe abc      |
| 查看进程/应用资源消耗 | pm2 monit                             |
| 查看进程/应用日志     | pm2 logs abc                          |
| 查看所有进程/应用日志 | pm2 logs                              |
| 重新启动进程/应用     | pm2 restart abc                       |
| 重新启动所有进程/应用 | pm2 restart all                       |
